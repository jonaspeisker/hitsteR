---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  eval = FALSE
)
```

# hitsteR <a href="https://github.com/jonaspeisker/hitsteR"><img src="man/figures/logo.png" align="right" height="138" /></a>

<!-- badges: start -->
[![R-CMD-check](https://github.com/jonaspeisker/hitsteR/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/jonaspeisker/hitsteR/actions/workflows/R-CMD-check.yaml)
[![Codecov test coverage](https://codecov.io/gh/jonaspeisker/hitsteR/graph/badge.svg)](https://app.codecov.io/gh/jonaspeisker/hitsteR)
<!-- badges: end -->

hitsteR is an [R](https://www.r-project.org/) package to make a song guessing game. Based on a Spotify playlist, it generates a pdf of playing cards with artist, year, and song title on one side and a QR code to the track on the other side.

## Installation

You can install the development version of hitsteR from [GitHub](https://github.com/) with:

``` r
devtools::install_github("jonaspeisker/hitsteR")
```

## Setup

Before beginning, create a Spotify playlist or select a public one that you want to turn into a game. The main goal of the game is to build a timeline of songs which makes it a fun way to discover new music (good or bad) and get a sense how styles evolved over time. The playlist can be a wild mix or focus on a particular genre but the years should span a long enough time period to be distinguishable from each other. As a rule of thumb, at least 50 years are recommended. 

Start by assigning your Spotify client ID and client secret to environment variables. You can get them at the [Spotify developer dashboard](https://developer.spotify.com/) and creating a new application. The credentials `my_spotify_client_id` and `my_spotify_client_secret` can be passed directly to `set_spotify_credentials()` or set in a different file, such as `.Renviron`.

```{r setup}
library(hitsteR)
source(".Renviron")
set_spotify_credentials(my_spotify_client_id, my_spotify_client_secret)
#> Spotify credentials successfully set.
```

## Get and clean tracks from Spotify API

The following example uses the playlist [Top 100 Greatest Songs of All Time](https://open.spotify.com/playlist/6i2Qd6OpeRBAzxfscNXeWp?si=770c9e4eaee14574). `get_track_metadata()` takes only a [Spotify playlist ID](https://developer.spotify.com/documentation/web-api/concepts/spotify-uris-ids) as argument. 

```{r get-tracks}
my_track_metadata_raw <- get_track_metadata(playlist_id = "6i2Qd6OpeRBAzxfscNXeWp")
#> Playlist contains 117 tracks.
#> Got raw data on 117 tracks.
```

`clean_track_metadata()` tidies up the raw data returned by the API:

```{r clean-tracks}
my_track_metadata <- clean_track_metadata(my_track_metadata_raw)
#> Cleaned data on 117 tracks.
```

## Make card layout

Once the data is prepared, the pdf can be generated with `make_cards()`. 

```{r make-cards}
make_cards(tracks = my_tracks, color = TRUE)
#> Wrote file to ./hitster_small_a4_color.pdf
```

## Prepare cards

- Print the pdf double-sided and mirrored on the long edge. For best results use heavy paper or laminate the pages.
- Cut pages along the marks.

## Rules

- The cards are stacked in the middle with the QR code on top. 
- Each player starts with one open card. The goal of the game is to build a timeline of tracks around this card.
- Players draw cards in turn. The QR code is scanned by somebody else which opens the Spotify app and plays the track. If the card is placed correctly in the player's timeline, they can keep it.
- The first player to reach a previously agreed number of cards wins.

## Example

![Example output](inst/extdata/example.png)

